# Orchestration: Billy (2026-02-22T18:17)

**Agent:** Billy (Squad Expert)  
**Mode:** background  
**Model:** claude-sonnet-4.5  
**Task:** Audit Squad SDK API surface and map Building/Floor/Office concepts  
**Status:** Completed  

## Work Done

Comprehensive audit of @bradygaster/squad-sdk@0.8.2 API surface and mapping to UI concepts:

### SDK Layers Analyzed

1. **Client Layer** (`dist/client/`)
   - SquadClientWithPool: connection, session pooling, event bus
   - SessionPool: concurrent session management, status tracking, capacity limits
   
2. **Event Bus Layer** (`dist/runtime/`)
   - EventBus: cross-session pub/sub, typed payloads, error isolation
   - Lifecycle events: session:created, session:idle, session:error, session:destroyed
   - WebSocket bridge for real-time integration
   - StreamingPipeline: token-by-token content, usage tracking, reasoning deltas
   
3. **Coordinator Layer** (`dist/coordinator/`)
   - SquadCoordinator: message routing, spawn strategy selection, parallel spawning
   
4. **Config Layer** (`dist/config/`)
   - Config resolution: walk-up directory discovery, schema validation
   - SquadConfig shape: models, routing, agents, ceremonies, hooks, plugins
   
5. **Agent Lifecycle Layer** (`dist/agents/`)
   - AgentLifecycleManager: spawn-to-destroy management with charter compilation
   - CharterCompiler: parse agent charters into AgentCharter objects
   - History shadow: persistent context between sessions

### Concept-to-SDK Mapping

| Concept | SDK Coverage | Custom Work |
|---------|---|---|
| **Building (Hub)** | 0% | SquadRegistry for multi-directory discovery, cross-squad aggregation |
| **Floor (Squad)** | 90% | Thin wrapper combining Client + Coordinator + Observer + Lifecycle |
| **Office (Session)** | 95% | IPC bridge to renderer, UI state management |

### Gap Analysis Summary

- **Building Discovery:** SDK has resolveSquad(dir) per directory; need filesystem scanning + user registry
- **Cross-Squad Events:** SDK EventBus per squad; need bridge aggregating multiple buses
- **Session Pool Mgmt:** OK—SessionPool handles maxConcurrent, idleTimeout, healthCheckInterval natively
- **Real-Time Streaming:** OK—StreamingPipeline provides delta, usage, reasoning events
- **File Watching:** OK—SquadObserver watches .squad/ directory for config/agent/decision changes
- **Health Monitoring:** OK—HealthMonitor per client, aggregatable across squads

## Recommendations

**Implementation Order:**
1. **SquadFloor class** — Wrap one SquadClientWithPool + AgentLifecycleManager + SquadObserver
2. **IPC Event Bridge** — Forward EventBus + StreamingPipeline to renderer via ipcMain
3. **SquadRegistry class** — Manage multiple SquadFloor instances, scan directories, persist known projects
4. **Cross-Squad Aggregation** — Global health status, combined event stream, total session counts

## Artifacts

- Analysis document with complete SDK audit and mapping tables
- Gap analysis showing 0% Building coverage (custom), 90%+ Floor/Office coverage (SDK)
- Decision log for architectural direction (custom SquadRegistry + thin Floor wrapper)

## Notes

Analysis based on @bradygaster/squad-sdk@0.8.2 public declarations. SDK fully supports Floor and Office concepts; Building is architectural addition. No fundamental blockers identified.
