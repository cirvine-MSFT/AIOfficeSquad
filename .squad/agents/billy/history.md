# Billy — History

## Learnings
- Project started 2026-02-22. Squad domain expert for AI Office Squad.
- Squad CLI: @bradygaster/squad-cli v0.7.0, depends on @bradygaster/squad-sdk v0.7.0.
- Squad repo: bradygaster/squad — single index.js (~63KB), templates/, docs/.
- Key Squad concepts to map into AIOffice: team roster, agent charters, ceremonies, decisions, casting.
- AIOffice concepts to preserve: walkable office, desk assignment, chat, terminal view, PTY processes.
- **2026-02-21:** Completed comprehensive Squad → AIOffice concept mapping analysis:
  - Squad is file-based multi-agent orchestration via Copilot CLI/VS Code
  - AIOffice is pixel-art UI managing PTY processes (Claude Code, Copilot CLI)
  - Core challenge: Bridge Squad's `task` tool spawning to AIOffice's PTY management
  - Key integration points: agent spawn bridge, state persistence, memory system, decisions visualization, ceremony triggering
  - All Squad state lives in `.squad/` directory (git-committed); AIOffice will be visualization layer over this
  - Proposed 4-phase migration: read-only integration → basic spawning → full memory system → visual enhancements
  - Critical gaps: no sub-agent spawn protocol, no persistent memory, no shared state in current AIOffice
  - Squad architecture: coordinator spawns agents in parallel via `task` tool, each agent has own context window (200K tokens)
  - Squad memory: personal (history.md per agent), shared (decisions.md), skills (.squad/skills/)
  - Squad ceremonies: design review (before complex work), retrospective (after failures), configurable in ceremonies.md
  - AIOffice architecture: Express server with PTY management, JSONL watcher for Claude output, Phaser 3 web app for visualization
  - Mapping deliverable: `.squad/decisions/inbox/billy-squad-concept-mapping.md` created with full analysis
- **2026-02-22:** Completed SDK capabilities audit and Building/Floor/Office mapping for @bradygaster/squad-sdk@0.8.2:
  - SDK upgraded from v0.7.0 to v0.8.2 — now has full programmatic API (no longer just a single index.js)
  - Key client: `SquadClientWithPool` — combines connection management, `SessionPool`, and `EventBus`
  - Session lifecycle fully supported: create, resume, list, delete, send messages, streaming, hooks
  - `AgentLifecycleManager` handles spawn-to-destroy with charter compilation + model selection
  - `SquadCoordinator` routes messages to agents (direct/single/multi/fallback strategies)
  - `StreamingPipeline` provides token-by-token streaming with delta, usage, and reasoning handlers
  - `EventBus` has typed payloads for 9 event types (session:created/idle/error/destroyed, message, tool_call, routing, milestone, pool:health)
  - `startWSBridge()` broadcasts EventBus over WebSocket — key for external consumers
  - `SquadObserver` watches `.squad/` directory for file changes (agent, casting, config, decision, skill categories)
  - **Building (Hub) = 0% SDK coverage** — No multi-squad concept. Need custom SquadRegistry for multi-directory discovery
  - **Floor (Squad) = ~90% SDK coverage** — One SquadClientWithPool + Coordinator + Observer per squad
  - **Office (Session) = ~95% SDK coverage** — Full session lifecycle, streaming, hooks, permissions
  - Config resolution: walks up directory tree for squad.config.ts/js/json or .squad/config.json
  - `resolveSquad(startDir)` finds `.squad/` directory but only for single squad scope
  - Gap: Cross-squad routing, cross-squad event aggregation, squad discovery/enumeration all need custom code
  - Recommended: SquadFloor wrapper → IPC Event Bridge → SquadRegistry → Cross-Squad Aggregation
  - Mapping deliverable: `.squad/decisions/inbox/billy-sdk-building-mapping.md`
- **2026-02-22:** Completed SDK feasibility review of Building/Floor/Office mockup (apps/desktop/mockup.html):
  - Mockup defines 3-level drill-down: Building (hub) → Floor (squad) → Office (session)
  - Floor level: ~90% SDK coverage — `loadConfig()`, `SessionPool`, `AgentLifecycleManager` cover almost everything
  - Office level: ~95% SDK coverage — `StreamingPipeline`, `SquadSession.sendMessage()`, `EventBus` cover chat + terminal + status
  - Building level: 0% SDK coverage — multi-squad discovery/aggregation requires custom `SquadRegistry` + `HubAggregator` (~350 LOC)
  - None of the gaps require SDK changes; all buildable as app-layer code
  - Key missing mockup features identified: CostTracker (real-time $), WS Bridge (push events), SquadObserver (file watch feed), permissions/ask_user dialogs, ReasoningDelta display
  - `startWSBridge(bus)` on port 6277 is the critical integration point — built specifically for external consumers like us
  - CostTracker has per-agent and per-session breakdowns with `wireToEventBus()` for live updates
  - RalphMonitor can power auto-idle detection (move agents to water cooler after inactivity)
  - SDK v0.8.2 added: upstream module (cross-squad context inheritance), casting engine, marketplace, sharing, benchmarks, i18n, offline mode, OTel metrics
  - Recommended 4-phase implementation: easy wins (Floor+Office) → WS Bridge+Cost+Observer → Building hub → polish
  - Feasibility deliverable: `.squad/decisions/inbox/billy-mockup-feasibility.md`
